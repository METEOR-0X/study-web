<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIRASA | Ù…Ù†ØµØ© Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡</title>
    
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ========================================= */
        /* 1. Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Dark Mode)               */
        /* ========================================= */
        :root {
            --bg-body: #171616;
            --bg-header: #1e1d1d;
            --bg-card: #262626;
            --text-primary: #ffffff;
            --text-secondary: #a3a3a3;
            --accent: #ffffff;
            --border-color: #333333;
            --modal-bg: rgba(23, 22, 22, 0.85);
            --lesson-color: #3b82f6;
            --exercise-color: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'IBM Plex Sans Arabic', sans-serif; }
        body { background-color: var(--bg-body); color: var(--text-primary); line-height: 1.6; }

        /* ========================================= */
        /* 2. Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ (Navbar)                  */
        /* ========================================= */
        .navbar { background-color: var(--bg-header); height: 70px; display: flex; justify-content: space-between; align-items: center; padding: 0 40px; border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 1000; }
        .logo { font-size: 26px; font-weight: 700; color: var(--text-primary); letter-spacing: 2px; text-decoration: none; font-family: sans-serif; cursor: pointer; user-select: none; }
        .nav-links { display: flex; gap: 35px; list-style: none; transition: all 0.3s ease; }
        .nav-item { text-decoration: none; color: var(--text-secondary); font-weight: 600; font-size: 16px; transition: color 0.3s ease; position: relative; padding: 5px 0; cursor: pointer; display: block; }
        .nav-item:hover, .nav-item.active { color: var(--accent); }
        .nav-item::after { content: ''; position: absolute; width: 0; height: 2px; bottom: 0; right: 0; background-color: var(--accent); transition: width 0.3s ease; }
        .nav-item:hover::after, .nav-item.active::after { width: 100%; }
        
        .menu-btn { display: none; cursor: pointer; flex-direction: column; gap: 5px; z-index: 1001; }
        .menu-btn span { width: 25px; height: 3px; background-color: var(--text-primary); transition: 0.3s; border-radius: 2px; }
        #menu-toggle { display: none; }

        /* ========================================= */
        /* 3. ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰                */
        /* ========================================= */
        .main-content { max-width: 1100px; margin: 40px auto; padding: 20px; }
        #loader { text-align: center; color: var(--text-secondary); margin-top: 50px; font-size: 1.2rem; }

        .lessons-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .card { background-color: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; display: flex; flex-direction: column; justify-content: space-between; transition: transform 0.2s, box-shadow 0.2s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.4); border-color: #555; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        
        .badge { font-size: 0.75rem; padding: 4px 10px; border-radius: 6px; font-weight: bold; }
        .badge-lesson { background-color: rgba(59, 130, 246, 0.1); color: var(--lesson-color); border: 1px solid var(--lesson-color); }
        .badge-exercise { background-color: rgba(239, 68, 68, 0.1); color: var(--exercise-color); border: 1px solid var(--exercise-color); }
        
        .date { font-size: 0.8rem; color: var(--text-secondary); }
        .card-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 20px; color: var(--text-primary); line-height: 1.5; }
        
        .new-tag { color: #10b981; font-size: 0.8rem; margin-right: 8px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

        .btn-download { display: block; width: 100%; text-align: center; background-color: transparent; color: var(--text-primary); text-decoration: none; padding: 10px; border-radius: 8px; font-weight: 600; border: 1px solid var(--text-secondary); transition: all 0.2s ease; }
        .btn-download:hover { background-color: var(--text-primary); color: var(--bg-body); }

        /* ========================================= */
        /* 4. Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ø±ÙŠØ© (Admin Modal)           */
        /* ========================================= */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--modal-bg); backdrop-filter: blur(8px); display: flex; justify-content: center; align-items: center; z-index: 9999; opacity: 0; pointer-events: none; transition: 0.3s ease; }
        .modal-overlay.active { opacity: 1; pointer-events: auto; }
        .modal-box { background-color: var(--bg-header); border: 1px solid var(--border-color); padding: 40px; border-radius: 15px; width: 90%; max-width: 400px; text-align: center; transform: translateY(20px); transition: 0.3s ease; position: relative; }
        .modal-overlay.active .modal-box { transform: translateY(0); }
        .modal-box h3 { margin-bottom: 20px; color: var(--text-primary); }
        .modal-box input { width: 100%; padding: 12px; margin-bottom: 20px; background-color: var(--bg-body); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 8px; font-size: 16px; text-align: center; letter-spacing: 3px; }
        .modal-box input:focus { outline: none; border-color: var(--text-secondary); }
        .modal-box button { width: 100%; padding: 12px; background-color: var(--text-primary); color: var(--bg-body); border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.2s; }
        .modal-box button:hover { opacity: 0.8; }
        .close-modal { position: absolute; top: 15px; right: 20px; cursor: pointer; color: var(--text-secondary); font-size: 20px; }
        #auth-msg { margin-top: 15px; font-size: 14px; display: block; height: 20px; }

        /* ========================================= */
        /* 5. Ø§Ù„ØªØ¬Ø§ÙˆØ¨ (Mobile)                       */
        /* ========================================= */
        @media (max-width: 768px) {
            .navbar { padding: 0 20px; }
            .menu-btn { display: flex; }
            .nav-links { position: absolute; top: 70px; right: 0; width: 100%; background-color: var(--bg-header); flex-direction: column; align-items: center; gap: 20px; padding: 20px 0; border-bottom: 1px solid var(--border-color); max-height: 0; overflow: hidden; opacity: 0; transition: all 0.3s ease; }
            #menu-toggle:checked ~ .nav-links { max-height: 300px; opacity: 1; padding: 20px 0; }
            #menu-toggle:checked ~ .menu-btn span:nth-child(1) { transform: translateY(8px) rotate(45deg); }
            #menu-toggle:checked ~ .menu-btn span:nth-child(2) { opacity: 0; }
            #menu-toggle:checked ~ .menu-btn span:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div id="secret-logo" class="logo">DIRASA</div>

        <input type="checkbox" id="menu-toggle">
        <label for="menu-toggle" class="menu-btn">
            <span></span><span></span><span></span>
        </label>

        <ul class="nav-links">
            <li><a href="#" class="nav-item active">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
            <li><a href="#" class="nav-item">Ø§Ù„Ù…Ù„Ø®ØµØ§Øª</a></li>
            <li><a href="#" class="nav-item">Ø§Ù„Ø¯Ø±ÙˆØ³</a></li>
            <li><a href="#" class="nav-item">Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</a></li>
        </ul>
    </nav>

    <div class="modal-overlay" id="admin-modal">
        <div class="modal-box">
            <span class="close-modal" id="close-btn">âœ–</span>
            <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</h3>
            <input type="password" id="admin-pass" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ">
            <button onclick="verifyAdmin()">Ø¯Ø®ÙˆÙ„</button>
            <span id="auth-msg"></span>
        </div>
    </div>

    <main class="main-content">
        <div id="loader">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯Ø±ÙˆØ³...</div>
        <div class="lessons-grid" id="lessons-container">
            </div>
    </main>

    <script>
        // ==========================================
        // 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø·
        // ==========================================
        
        // 1. Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ CSV Ø§Ù„Ø®Ø§Øµ Ø¨Ù€ Google Sheet Ù‡Ù†Ø§
        const SHEET_CSV_URL = 'PASTE_YOUR_GOOGLE_SHEET_LINK_HERE';
        
        // 2. Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ Google Form Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ (Ù…Ø´ÙØ±Ø§Ù‹ Ø¨ØµÙŠØºØ© Base64)
        // Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´ÙØ±: Ø§Ø°Ù‡Ø¨ Ù„Ù…ÙˆÙ‚Ø¹ base64encode.org ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙˆØ±Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§Ùƒ ÙˆØ§Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©.
        const OBFUSCATED_FORM_URL = "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZm9ybXMvZC9lLzFGQUlwUUxTZXgtQWpXY1hfdmZqUkFHeGFaMTUteUV5cFhCUUFMdHN3RTZtOGF5UnVnaEtZTVZRL3ZpZXdmb3JtP3VzcD1zaGFyaW5nJm91aWQ9MTE3NTkwNjgwMzYyNTg3NDYwOTQ1"; 
        
        // 3. Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ø´ÙØ±Ø© Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± (SHA-256)
        // Ù‡Ø°Ù‡ Ø§Ù„Ø¨ØµÙ…Ø© ØªØ¹ÙˆØ¯ Ù„ÙƒÙ„Ù…Ø©: admin123
        const TARGET_HASH = "1b94d1883565d1e51f1479aeaf5bdceff65deeed99937b598b610d928fdaa538";

        // ==========================================
        // 2. ÙƒÙˆØ¯ Ø¬Ù„Ø¨ Ø§Ù„Ø¯Ø±ÙˆØ³ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
        // ==========================================
        async function fetchLessons() {
            try {
                if(SHEET_CSV_URL === 'PASTE_YOUR_GOOGLE_SHEET_LINK_HERE') {
                    document.getElementById('loader').innerHTML = 'âš ï¸ ÙŠØ±Ø¬Ù‰ ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Google Sheet ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ù„ÙƒÙŠ ØªØ¸Ù‡Ø± Ø§Ù„Ø¯Ø±ÙˆØ³.';
                    return;
                }

                const response = await fetch(SHEET_CSV_URL);
                const data = await response.text();
                
                const rows = data.split('\n').slice(1);
                const container = document.getElementById('lessons-container');
                document.getElementById('loader').style.display = 'none';

                let newCount = 0;

                rows.reverse().forEach(row => {
                    const cols = row.split(','); 
                    if (cols.length < 3) return;

                    const timestamp = cols[0].replace(/"/g, ''); 
                    const title = cols[1].replace(/"/g, '');     
                    const type = cols[2].replace(/"/g, '');      
                    const link = cols[3].replace(/"/g, '').trim(); 

                    const isNew = isAddedToday(timestamp);
                    if (isNew) newCount++;

                    const badgeClass = type.includes('Ø¯Ø±Ø³') ? 'badge-lesson' : 'badge-exercise';

                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="card-header">
                            <span class="badge ${badgeClass}">${type}</span>
                            <span class="date">${formatDate(timestamp)}</span>
                        </div>
                        <h3 class="card-title">
                            ${isNew ? '<span class="new-tag">â— Ø¬Ø¯ÙŠØ¯</span>' : ''}
                            ${title}
                        </h3>
                        <a href="${link}" target="_blank" class="btn-download">ØªØ­Ù…ÙŠÙ„ / Ø¹Ø±Ø¶ ğŸ“„</a>
                    `;
                    container.appendChild(card);
                });

                if (newCount > 0) {
                    setTimeout(() => alert(`ğŸ”” ØªÙ†Ø¨ÙŠÙ‡: ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${newCount} Ù…Ù„ÙØ§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ÙŠÙˆÙ…!`), 1000);
                }

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loader').innerText = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø±Ø§Ø¨Ø· Google Sheet.";
            }
        }

        function isAddedToday(dateString) {
            const today = new Date().toDateString();
            const itemDate = new Date(dateString).toDateString();
            return today === itemDate;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-EG');
        }

        // ==========================================
        // 3. ÙƒÙˆØ¯ Ø­Ù…Ø§ÙŠØ© ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ø±ÙŠØ© (SHA-256)
        // ==========================================
        const modal = document.getElementById('admin-modal');
        const logo = document.getElementById('secret-logo');
        const closeBtn = document.getElementById('close-btn');

        logo.addEventListener('click', () => {
            modal.classList.add('active');
            document.getElementById('admin-pass').value = ''; 
            document.getElementById('auth-msg').textContent = '';
            document.getElementById('admin-pass').focus();
        });

        closeBtn.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        async function verifyAdmin() {
            const pass = document.getElementById('admin-pass').value;
            const msg = document.getElementById('auth-msg');
            if(!pass) return;

            try {
                // ØªØ´ÙÙŠØ± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø© Ø¨ØªÙ‚Ù†ÙŠØ© SHA-256 Ø§Ù„Ø¢Ù…Ù†Ø©
                const encoder = new TextEncoder();
                const data = encoder.encode(pass);
                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');

                if (hashHex === TARGET_HASH) {
                    msg.style.color = "#10b981"; // Ø£Ø®Ø¶Ø±
                    msg.textContent = "ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± ØµØ­ÙŠØ­Ø©.. Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØªØ­!";
                    setTimeout(() => {
                        window.open(atob(OBFUSCATED_FORM_URL), '_blank');
                        modal.classList.remove('active');
                    }, 1000);
                } else {
                    msg.style.color = "#ef4444"; // Ø£Ø­Ù…Ø±
                    msg.textContent = "Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­!";
                }
            } catch (error) {
                console.error("Encryption error:", error);
                msg.style.color = "#ef4444";
                msg.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù‚Ù‚.";
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        fetchLessons();
    </script>
</body>
</html>
